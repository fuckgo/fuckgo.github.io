<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>信息收集之我见 | $_Fuck | 白天搞笑的废物，晚上抑郁的怪物。</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Web安全">
    <meta name="description" content="信息收集之我见标签（空格分隔）： web安全   来源网络，回馈网络  对一个网站挖掘的深浅来说就得看你收集的如何，这说明信息收集在漏洞挖掘中是非常的重要的。 子域名收集子域名收集是最简单的收集手法之一，有很多在线的工具可以直接套用，这里分享几个我经常用的。 开心的时候用用这个扫描器为什么这么说，因为这是我写的（你生气用的话我怕我屏幕里突然冒出一个拖孩） 1import requests2impo">
<meta name="keywords" content="Web安全">
<meta property="og:type" content="article">
<meta property="og:title" content="信息收集之我见">
<meta property="og:url" content="https:&#x2F;&#x2F;fuckgo.github.io&#x2F;2019&#x2F;12&#x2F;18&#x2F;%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81&#x2F;index.html">
<meta property="og:site_name" content="$_Fuck">
<meta property="og:description" content="信息收集之我见标签（空格分隔）： web安全   来源网络，回馈网络  对一个网站挖掘的深浅来说就得看你收集的如何，这说明信息收集在漏洞挖掘中是非常的重要的。 子域名收集子域名收集是最简单的收集手法之一，有很多在线的工具可以直接套用，这里分享几个我经常用的。 开心的时候用用这个扫描器为什么这么说，因为这是我写的（你生气用的话我怕我屏幕里突然冒出一个拖孩） 1import requests2impo">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;qs0mh7b7r6hsaza75elhutsg&#x2F;image_1dbuqgbbl2bh1v10nm68jh1j509.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;1iyab59sog11djizbbiw9h0c&#x2F;image_1dbuqjj0a10o118r155p1q491k1lm.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;qltdwf3s73s6i06193dxfq85&#x2F;image_1dbuqkf3l1qdehf418221uslika13.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;gwt2yb1mh4yk7tn2baumapxv&#x2F;image_1dbutat2nhgqgid17iv68f2g42d.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;z79vppxuhs029n7lzpdhl1v9&#x2F;image_1dbutad6a1965dff1d06kuoi2m20.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;wkbp83yz8x0fkewwcyh7vx9b&#x2F;image_1dbuu62uk1f3q1gfqbtk1r5l11qi3p.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;ztnx3vmhmv1n8amubgs2k6m5&#x2F;image_1dbv9cp101p0h1i1cid6g35190n46.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;z4qkha9n1un7ukk67g1uqii5&#x2F;image_1dbv9k8liv5n18n814fu18j25k53.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;o982kurvzt9wd1psstmsx5du&#x2F;image_1dbvbbve839lj94hs8d92cp.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;88w8pjy2e0vq3ypx2n0qbbfd&#x2F;image_1dbvble0op36hmi1ter16ck1vt816.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;c4nub4ydmq1402ccx0sav3x9&#x2F;image_1dbvfielukp81f701hcd1qnq12e41j.png">
<meta property="og:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;6c72ksiz5fz1js4zomzvy6q3&#x2F;image_1dbvfuq8rvjho6e3qd1etn1va420.png">
<meta property="og:updated_time" content="2019-12-17T19:21:48.080Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;static.zybuluo.com&#x2F;1kbfree&#x2F;qs0mh7b7r6hsaza75elhutsg&#x2F;image_1dbuqgbbl2bh1v10nm68jh1j509.png">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" target="_blank" rel="noopener" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/blog.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">$_Fuck</h5>
          <a href="mailto:以凡人之躯比肩神明" target="_blank" rel="noopener" title="以凡人之躯比肩神明" class="mail">以凡人之躯比肩神明</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-address-book"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/Web%E5%AE%89%E5%85%A8/"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/%E5%85%B4%E8%B6%A3%E7%88%B1%E5%A5%BD"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/link"  >
                <i class="icon icon-lg icon-link"></i>
                友情链接
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" target="_blank" rel="noopener" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">信息收集之我见</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" target="_blank" rel="noopener" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="検索">
            <a href="javascript:;" target="_blank" rel="noopener" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" target="_blank" rel="noopener" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">信息收集之我见</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-12-17T18:59:08.000Z" itemprop="datePublished" class="page-time">
  2019-12-18
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%85%B4%E8%B6%A3%E7%88%B1%E5%A5%BD/">兴趣爱好</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container-fluid blog body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#信息收集之我见"><span class="post-toc-number">1.</span> <span class="post-toc-text">信息收集之我见</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#子域名收集"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">子域名收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#开心的时候用用这个扫描器"><span class="post-toc-number">1.0.1.1.</span> <span class="post-toc-text">开心的时候用用这个扫描器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#github开源的子域名扫描器"><span class="post-toc-number">1.0.1.2.</span> <span class="post-toc-text">github开源的子域名扫描器</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#在线网站收集"><span class="post-toc-number">1.0.1.3.</span> <span class="post-toc-text">在线网站收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1、"><span class="post-toc-number">1.0.1.3.1.</span> <span class="post-toc-text">1、</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2、"><span class="post-toc-number">1.0.1.3.2.</span> <span class="post-toc-text">2、</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#端口信息收集"><span class="post-toc-number">1.0.2.</span> <span class="post-toc-text">端口信息收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#扫描端口并且标记可以爆破的服务"><span class="post-toc-number">1.0.2.1.</span> <span class="post-toc-text">扫描端口并且标记可以爆破的服务</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#判断常见的漏洞并扫描端口"><span class="post-toc-number">1.0.2.2.</span> <span class="post-toc-text">判断常见的漏洞并扫描端口</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#精确判断漏洞并扫描端口"><span class="post-toc-number">1.0.2.3.</span> <span class="post-toc-text">精确判断漏洞并扫描端口</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#我喜欢这样做"><span class="post-toc-number">1.0.2.4.</span> <span class="post-toc-text">我喜欢这样做</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#c段信息收集"><span class="post-toc-number">1.0.3.</span> <span class="post-toc-text">c段信息收集</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#目录信息收集"><span class="post-toc-number">1.0.4.</span> <span class="post-toc-text">目录信息收集</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#谷歌语法收集铭感文件"><span class="post-toc-number">1.0.5.</span> <span class="post-toc-text">谷歌语法收集铭感文件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#小技巧"><span class="post-toc-number">1.0.5.1.</span> <span class="post-toc-text">小技巧</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用云网盘搜索工具搜集敏感文件"><span class="post-toc-number">1.0.6.</span> <span class="post-toc-text">利用云网盘搜索工具搜集敏感文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用gayhub来收集信息"><span class="post-toc-number">1.0.7.</span> <span class="post-toc-text">利用gayhub来收集信息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#针对网站性收集"><span class="post-toc-number">1.0.8.</span> <span class="post-toc-text">针对网站性收集</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#1、把网站弄报错，看是什么cms，或者看返回包回显是什么中间件这些"><span class="post-toc-number">1.0.8.0.1.</span> <span class="post-toc-text">1、把网站弄报错，看是什么cms，或者看返回包回显是什么中间件这些</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2、看是linux还是window"><span class="post-toc-number">1.0.8.0.2.</span> <span class="post-toc-text">2、看是linux还是window</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#3、可以去云溪等在线识别指纹的网站看指纹信息"><span class="post-toc-number">1.0.8.0.3.</span> <span class="post-toc-text">3、可以去云溪等在线识别指纹的网站看指纹信息</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#4、对waf进行识别"><span class="post-toc-number">1.0.8.0.4.</span> <span class="post-toc-text">4、对waf进行识别</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#5、对网站whois查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）"><span class="post-toc-number">1.0.8.0.5.</span> <span class="post-toc-text">5、对网站whois查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#6、看html源代码，在一起项目测试的时候，我在找html源代码的时候发现一个注释的js文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没get到shell，所以你要知道这回事而不要记住这件事）"><span class="post-toc-number">1.0.8.0.6.</span> <span class="post-toc-text">6、看html源代码，在一起项目测试的时候，我在找html源代码的时候发现一个注释的js文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没get到shell，所以你要知道这回事而不要记住这件事）</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#7、网站真实ip识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来"><span class="post-toc-number">1.0.8.0.7.</span> <span class="post-toc-text">7、网站真实ip识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#8、服务器ssh配置信息"><span class="post-toc-number">1.0.8.0.8.</span> <span class="post-toc-text">8、服务器ssh配置信息</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#9、敏感文件爆破"><span class="post-toc-number">1.0.8.0.9.</span> <span class="post-toc-text">9、敏感文件爆破</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#10、根据目标系统情况"><span class="post-toc-number">1.0.8.0.10.</span> <span class="post-toc-text">10、根据目标系统情况</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#敏感目录泄露"><span class="post-toc-number">1.0.9.</span> <span class="post-toc-text">敏感目录泄露</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#利用shodan、fofa等收集信息"><span class="post-toc-number">1.0.10.</span> <span class="post-toc-text">利用shodan、fofa等收集信息</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#思路扩展"><span class="post-toc-number">1.0.11.</span> <span class="post-toc-text">思路扩展</span></a></li></ol></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-信息收集之我见"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">信息收集之我见</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-12-18 02:59:08" datetime="2019-12-17T18:59:08.000Z"  itemprop="datePublished">2019-12-18</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/%E5%85%B4%E8%B6%A3%E7%88%B1%E5%A5%BD/">兴趣爱好</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="信息收集之我见"><a href="#信息收集之我见" class="headerlink" title="信息收集之我见"></a>信息收集之我见</h1><p>标签（空格分隔）： web安全</p>
<hr>
<blockquote>
<p>来源网络，回馈网络</p>
</blockquote>
<p>对一个网站挖掘的深浅来说就得看你收集的如何，这说明信息收集在漏洞挖掘中是非常的重要的。</p>
<h3 id="子域名收集"><a href="#子域名收集" class="headerlink" title="子域名收集"></a>子域名收集</h3><p>子域名收集是最简单的收集手法之一，有很多在线的工具可以直接套用，这里分享几个我经常用的。</p>
<h4 id="开心的时候用用这个扫描器"><a href="#开心的时候用用这个扫描器" class="headerlink" title="开心的时候用用这个扫描器"></a>开心的时候用用这个扫描器</h4><p>为什么这么说，因为这是我写的（你生气用的话我怕我屏幕里突然冒出一个拖孩）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">url = input( <span class="string">'url(如baidu.com): '</span> )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">head=&#123;<span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0'</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line">ip = <span class="string">'http://site.ip138.com/&#123;&#125;'</span>.format( url )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># domain_url = url.split('.')</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># domain_url = domain_url[1]+'.'+domain_url[2]</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">domain_url = url</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line">domain = <span class="string">'http://site.ip138.com/&#123;&#125;/domain.htm'</span>.format( domain_url )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line">t = time.strftime(<span class="string">"%Y-%m-%d"</span>+<span class="string">'_'</span>, time.localtime())</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line">html_file = open( url+<span class="string">'_'</span>+t+<span class="string">'.html'</span>,<span class="string">'w'</span> )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">html_file.write( <span class="string">'''</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;head&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;title&gt;%s的扫描结果&lt;/title&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"&gt;&lt;/script&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"&gt;&lt;/script&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;style&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="string">pre&#123;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="string">margin: 0 0 0px;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="string">&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/style&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/head&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="string"></span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;ul id="myTab" class="nav nav-tabs navbar-fixed-top navbar navbar-default"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="string">    &lt;li class="active"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;a href="#ip" data-toggle="tab"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="string">             IP历史解析</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;/a&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"><span class="string">    &lt;/li&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="string">    &lt;li&gt;&lt;a href="#cms" data-toggle="tab"&gt;CMS识别&lt;/a&gt;&lt;/li&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"><span class="string">    &lt;li&gt;&lt;a href="#domain" data-toggle="tab"&gt;子域名信息&lt;/a&gt;&lt;/li&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;/ul&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;br&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;br&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;br&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;br&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;div id="myTabContent" class="tab-content"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span>%url )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IP</span><span class="params">( threading.Thread )</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, ip)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">        threading.Thread.__init__(self)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">        self.ip = ip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">        r = requests.get( self.ip,headers = head )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">        html = r.text</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">        bs = BeautifulSoup(html, <span class="string">"html.parser"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">        html_file.write(<span class="string">'&lt;div class="tab-pane fade in active" id="ip"&gt;'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> bs.find_all(<span class="string">'p'</span>):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">            ipc = i.get_text()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">            ip_html = <span class="string">'&lt;pre&gt;&#123;&#125;&lt;/pre&gt;'</span>.format( ipc )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">            html_file.write( ip_html )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">        html_file.write(<span class="string">'&lt;/div&gt;'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CMS</span><span class="params">( threading.Thread )</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, cms)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">        threading.Thread.__init__(self)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">        self.cms = cms</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">        cms = requests.post(<span class="string">'http://whatweb.bugscaner.com/what/'</span>, data=&#123;<span class="string">'url'</span>: self.cms&#125;, headers = head)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        text = cms.text</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">        Web_Frameworks = re.search(<span class="string">'"Web Frameworks": "(.*?)"]'</span>, text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">        Programming_Languages = re.search(<span class="string">'"Programming Languages":(.*?)"]'</span>, text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">        JavaScript_Frameworks = re.search(<span class="string">'"JavaScript Frameworks": (.*?)"]'</span>, text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">        CMS = re.search(<span class="string">'"CMS": (.*?)"]'</span>, text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">        Web_Server = re.search(<span class="string">'"Web Servers": (.*?)"]'</span>, text)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> CMS:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">            CMS = CMS.group(<span class="number">1</span>)+<span class="string">'"]'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> Programming_Languages:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">            Programming_Languages = Programming_Languages.group(<span class="number">1</span>)+<span class="string">'"]'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> JavaScript_Frameworks:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">            JavaScript_Frameworks = JavaScript_Frameworks.group(<span class="number">1</span>)+<span class="string">'"]'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> Web_Frameworks:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">            Web_Frameworks = Web_Frameworks.group(<span class="number">1</span>)+<span class="string">'"]'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> Web_Server:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">            Web_Server = Web_Server.group(<span class="number">1</span>)+<span class="string">'"]'</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">        html = <span class="string">'''</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;div class="tab-pane fade" id="cms"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;div class="table-responsive"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;table class="table table-condensed"&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"><span class="string">           &lt;tr&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;th&gt;web框架&lt;/th&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;th&gt;脚本版本&lt;/th&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;th&gt;JavaScript框架&lt;/th&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;th&gt;CMS框架&lt;/th&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;th&gt;web服务器&lt;/th&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"><span class="string">          &lt;/tr&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line"><span class="string">          &lt;tr&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;td&gt;&#123;0&#125;&lt;/td&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;td&gt;&#123;1&#125;&lt;/td&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;td&gt;&#123;2&#125;&lt;/td&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;td&gt;&#123;3&#125;&lt;/td&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line"><span class="string">            &lt;td&gt;&#123;4&#125;&lt;/td&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line"><span class="string">          &lt;/tr&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;/table&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;/div&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line"><span class="string">        &lt;/div&gt;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line"><span class="string">        '''</span>.format(Web_Frameworks,Programming_Languages,JavaScript_Frameworks,CMS,Web_Server)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">        html_file.write( html )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DOMAIN</span><span class="params">( threading.Thread )</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, domain)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line">        threading.Thread.__init__(self)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">        self.domain = domain</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line">        r = requests.get( self.domain,headers = head )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">        html = r.text</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">        bs = BeautifulSoup(html, <span class="string">"html.parser"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">        html_file.write(<span class="string">'&lt;div class="tab-pane fade in active" id="domain"'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">        num = <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> bs.find_all(<span class="string">'p'</span>):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">            num += <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">            html_file.write( <span class="string">'&lt;br&gt;'</span> )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">            domainc = i.get_text()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line">            domain_html = <span class="string">'&lt;pre&gt;[&#123;&#125;]： &#123;&#125;&lt;/pre&gt;'</span>.format( num,domainc )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line">            html_file.write( domain_html )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">            print( domain_html )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">        html_file.write(<span class="string">'&lt;/div&gt;'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">ip_cls = IP(ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">ip_html = ip_cls.run()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">cms_cls = CMS(url)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">cms_html = cms_cls.run()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">domain_cls = DOMAIN( domain )</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">domain_html = domain_cls.run()</span></pre></td></tr></table></figure>

<h4 id="github开源的子域名扫描器"><a href="#github开源的子域名扫描器" class="headerlink" title="github开源的子域名扫描器"></a>github开源的子域名扫描器</h4><p><a href="https://github.com/lijiejie/subDomainsBrute" target="_blank" rel="noopener">https://github.com/lijiejie/subDomainsBrute</a><br><a href="https://github.com/chuhades/dnsbrute" target="_blank" rel="noopener">https://github.com/chuhades/dnsbrute</a></p>
<h4 id="在线网站收集"><a href="#在线网站收集" class="headerlink" title="在线网站收集"></a>在线网站收集</h4><h5 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h5><p><a href="https://d.chinacycc.com/（非常推荐）" target="_blank" rel="noopener">https://d.chinacycc.com/（非常推荐）</a></p>
<p><img src="http://static.zybuluo.com/1kbfree/qs0mh7b7r6hsaza75elhutsg/image_1dbuqgbbl2bh1v10nm68jh1j509.png" alt="image_1dbuqgbbl2bh1v10nm68jh1j509.png-112kB"></p>
<p>然后不到30秒就出结果了</p>
<p><img src="http://static.zybuluo.com/1kbfree/1iyab59sog11djizbbiw9h0c/image_1dbuqjj0a10o118r155p1q491k1lm.png" alt="image_1dbuqjj0a10o118r155p1q491k1lm.png-34.3kB"></p>
<p><img src="http://static.zybuluo.com/1kbfree/qltdwf3s73s6i06193dxfq85/image_1dbuqkf3l1qdehf418221uslika13.png" alt="image_1dbuqkf3l1qdehf418221uslika13.png-175.7kB"></p>
<h5 id="2、"><a href="#2、" class="headerlink" title="2、"></a>2、</h5><p><a href="http://z.zcjun.com/" target="_blank" rel="noopener">http://z.zcjun.com/</a><br><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p>
<h3 id="端口信息收集"><a href="#端口信息收集" class="headerlink" title="端口信息收集"></a>端口信息收集</h3><h4 id="扫描端口并且标记可以爆破的服务"><a href="#扫描端口并且标记可以爆破的服务" class="headerlink" title="扫描端口并且标记可以爆破的服务"></a>扫描端口并且标记可以爆破的服务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">nmap 目标 --script&#x3D;ftp-brute,imap-brute,smtp-brute,pop3-brute,mongodb-brute,redis-brute,ms-sql-brute,rlogin-brute,rsync-brute,mysql-brute,pgsql-brute,oracle-sid-brute,oracle-brute,rtsp-url-brute,snmp-brute,svn-brute,telnet-brute,vnc-brute,xmpp-brute</span></pre></td></tr></table></figure>

<h4 id="判断常见的漏洞并扫描端口"><a href="#判断常见的漏洞并扫描端口" class="headerlink" title="判断常见的漏洞并扫描端口"></a>判断常见的漏洞并扫描端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">nmap 目标 --script&#x3D;auth,vuln</span></pre></td></tr></table></figure>

<h4 id="精确判断漏洞并扫描端口"><a href="#精确判断漏洞并扫描端口" class="headerlink" title="精确判断漏洞并扫描端口"></a>精确判断漏洞并扫描端口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">nmap 目标 --script&#x3D;dns-zone-transfer,ftp-anon,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,http-backup-finder,http-cisco-anyconnect,http-iis-short-name-brute,http-put,http-php-version,http-shellshock,http-robots.txt,http-svn-enum,http-webdav-scan,iis-buffer-overflow,iax2-version,memcached-info,mongodb-info,msrpc-enum,ms-sql-info,mysql-info,nrpe-enum,pptp-version,redis-info,rpcinfo,samba-vuln-cve-2012-1182,smb-vuln-ms08-067,smb-vuln-ms17-010,snmp-info,sshv1,xmpp-info,tftp-enum,teamspeak2-version</span></pre></td></tr></table></figure>

<h4 id="我喜欢这样做"><a href="#我喜欢这样做" class="headerlink" title="我喜欢这样做"></a>我喜欢这样做</h4><p>1、扫描子域名</p>
<p><img src="http://static.zybuluo.com/1kbfree/gwt2yb1mh4yk7tn2baumapxv/image_1dbutat2nhgqgid17iv68f2g42d.png" alt="image_1dbutat2nhgqgid17iv68f2g42d.png-64.3kB"></p>
<p>提取出域名/<code>ip</code></p>
<p><img src="http://static.zybuluo.com/1kbfree/z79vppxuhs029n7lzpdhl1v9/image_1dbutad6a1965dff1d06kuoi2m20.png" alt="image_1dbutad6a1965dff1d06kuoi2m20.png-172kB"></p>
<p>然后把域名放到<code>975.txt</code></p>
<p>2、批量扫描端口和漏洞检测</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">nmap -iL 975.txt --script&#x3D;auth,vuln,ftp-brute,imap-brute,smtp-brute,pop3-brute,mongodb-brute,redis-brute,ms-sql-brute,rlogin-brute,rsync-brute,mysql-brute,pgsql-brute,oracle-sid-brute,oracle-brute,rtsp-url-brute,snmp-brute,svn-brute,telnet-brute,vnc-brute,xmpp-brute &gt; scan.txt</span></pre></td></tr></table></figure>

<p>然后根据对应开放的端口进行针对性漏洞挖掘</p>
<h3 id="c段信息收集"><a href="#c段信息收集" class="headerlink" title="c段信息收集"></a>c段信息收集</h3><p>c段的话我一般都是使用<code>iis put</code>这款工具来扫描，可以自定义扫描<code>1-255</code>的端口并且还有返回服务器<code>banner</code>信息</p>
<p>自定义的端口</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">135,139,80,8080,15672,873,8983,7001,4848,6379,2381,8161,11211,5335,5336,7809,2181,9200,50070,50075,5984,2375,7809,16992,16993</span></pre></td></tr></table></figure>

<p><img src="http://static.zybuluo.com/1kbfree/wkbp83yz8x0fkewwcyh7vx9b/image_1dbuu62uk1f3q1gfqbtk1r5l11qi3p.png" alt="image_1dbuu62uk1f3q1gfqbtk1r5l11qi3p.png-114.4kB"></p>
<p>这里只是演示下他跑起来的美</p>
<h3 id="目录信息收集"><a href="#目录信息收集" class="headerlink" title="目录信息收集"></a>目录信息收集</h3><p>目录收集工具有很多，但是最看重的还是目录字典，之前我拿了很多工具的字典去重集合起来超级超级大，只不过是在之前电脑那里还原的时候忘记了备份、、、（说这句话主要是想让你们也可以这样子做，方便自己，然后发我一份，方便你我）</p>
<p>这里推荐一个工具<code>7kbstorm</code></p>
<p><a href="https://github.com/7kbstorm/7kbscan-WebPathBrute" target="_blank" rel="noopener">https://github.com/7kbstorm/7kbscan-WebPathBrute</a></p>
<blockquote>
<p>像<code>403</code>、<code>404</code>这种页面千万不要关闭，放目录里面扫就ok</p>
</blockquote>
<h3 id="谷歌语法收集铭感文件"><a href="#谷歌语法收集铭感文件" class="headerlink" title="谷歌语法收集铭感文件"></a>谷歌语法收集铭感文件</h3><p>最常见的就是用搜索引擎~</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">site:ooxx.com filetype:xls</span></pre></td></tr></table></figure>

<p>首先试试百度</p>
<p><img src="http://static.zybuluo.com/1kbfree/ztnx3vmhmv1n8amubgs2k6m5/image_1dbv9cp101p0h1i1cid6g35190n46.png" alt="image_1dbv9cp101p0h1i1cid6g35190n46.png-48.2kB"></p>
<blockquote>
<p>$!@!~~WDwadawicnm</p>
</blockquote>
<p>试试必应</p>
<p><img src="http://static.zybuluo.com/1kbfree/z4qkha9n1un7ukk67g1uqii5/image_1dbv9k8liv5n18n814fu18j25k53.png" alt="image_1dbv9k8liv5n18n814fu18j25k53.png-120kB"></p>
<p>这里主要是收集网站敏感文件（比如目标的某个系统手册演示的截图中截图到了用户名，然后我们可以根据用户名来爆破密码；甚至可以看看有没有写系统默认密码，或者一些后台的目录路径，如果有目录就可以尝试对其访问，说不定有未授权~）</p>
<p>还能尝试对后台进行查找</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx admin</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx login</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx system</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 管理</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 登录</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 内部</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 系统</span></pre></td></tr></table></figure>

<p>还可以查找邮箱，然后进行钓鱼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 邮件</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx email</span></pre></td></tr></table></figure>

<p>还可以查找<code>qq</code>群等，然后假装员工验证进去看群文件泄露了什么东东（这里有个技巧，去找客服聊天处，然后对整个过程抓包也就是看历史请求，如果运气好可能在请求的返回包中返回客服的姓名，如果只单纯的泄露了姓如<strong>张xx</strong>，那么你加群的时候就说你是<strong>小张工作号</strong>，说这个工作号的原因是可能小张已经在群里了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">注意事项：如果你是挖腾讯的话就不要看这条啦</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx qq</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 群</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 企鹅</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx 腾讯</span></pre></td></tr></table></figure>

<p>还可以对寻找一些公开的、危害大、普遍的漏洞的指纹，如下面的搜索<code>jboss</code>系统</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">site:ooxx.com inurl:jmx-console</span></pre></td></tr></table></figure>

<h4 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h4><p>比如下面一个站存在越权（但是越权的对象很难猜测）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx.xxx&#x2F;userinfo&#x2F;?uid&#x3D;2018-WOIDJWOIDJ-5201314</span></pre></td></tr></table></figure>

<p>那么我们可以尝试用搜索引擎来找</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">site:xxx.xxx inurl&#x3D;uid&#x3D;20</span></pre></td></tr></table></figure>

<h3 id="利用云网盘搜索工具搜集敏感文件"><a href="#利用云网盘搜索工具搜集敏感文件" class="headerlink" title="利用云网盘搜索工具搜集敏感文件"></a>利用云网盘搜索工具搜集敏感文件</h3><blockquote>
<p>公司员工可能把一些内部资料放在了公网网盘，然后被在线云网盘搜索的网站抓取了，我们就可以利用这个来对目标系统进行深入交流</p>
</blockquote>
<p>我这边主要用凌风云搜索</p>
<p><a href="https://www.lingfengyun.com/" target="_blank" rel="noopener">https://www.lingfengyun.com/</a></p>
<p><img src="http://static.zybuluo.com/1kbfree/o982kurvzt9wd1psstmsx5du/image_1dbvbbve839lj94hs8d92cp.png" alt="image_1dbvbbve839lj94hs8d92cp.png-143.4kB"></p>
<p>个人喜欢直接输入厂商名字然后搜索（比较全），然后边看电视（最好看鬼片，鬼出来的阶段想着找找找）边搜索</p>
<h3 id="利用gayhub来收集信息"><a href="#利用gayhub来收集信息" class="headerlink" title="利用gayhub来收集信息"></a>利用gayhub来收集信息</h3><p>1、打开<code>gayhub</code></p>
<p><img src="http://static.zybuluo.com/1kbfree/88w8pjy2e0vq3ypx2n0qbbfd/image_1dbvble0op36hmi1ter16ck1vt816.png" alt="image_1dbvble0op36hmi1ter16ck1vt816.png-151kB"></p>
<p>这里就是找<code>gayhub</code>全部开源项目内容中存在联想这个关键字的项目，这样子可以搜集到的方面更广，如果单纯只是对标题搜索，那么他们改成了<code>lenovo</code>你就搜不到了</p>
<p>然后说再多，也没这个好用</p>
<p><a href="https://sec.xiaomi.com/article/37" target="_blank" rel="noopener">https://sec.xiaomi.com/article/37</a></p>
<h3 id="针对网站性收集"><a href="#针对网站性收集" class="headerlink" title="针对网站性收集"></a>针对网站性收集</h3><h5 id="1、把网站弄报错，看是什么cms，或者看返回包回显是什么中间件这些"><a href="#1、把网站弄报错，看是什么cms，或者看返回包回显是什么中间件这些" class="headerlink" title="1、把网站弄报错，看是什么cms，或者看返回包回显是什么中间件这些"></a>1、把网站弄报错，看是什么<code>cms</code>，或者看返回包回显是什么中间件这些</h5><h5 id="2、看是linux还是window"><a href="#2、看是linux还是window" class="headerlink" title="2、看是linux还是window"></a>2、看是<code>linux</code>还是<code>window</code></h5><p>如目标<code>url</code>是<code>www.onlyfree.xxx/login</code>，那么改成<code>www.onlyfree.xxx/Login</code>看看能不能访问，如果可以访问就可能是<code>window</code>，否则可能是<code>linux</code></p>
<h5 id="3、可以去云溪等在线识别指纹的网站看指纹信息"><a href="#3、可以去云溪等在线识别指纹的网站看指纹信息" class="headerlink" title="3、可以去云溪等在线识别指纹的网站看指纹信息"></a>3、可以去云溪等在线识别指纹的网站看指纹信息</h5><p><a href="http://whatweb.bugscaner.com/look/" target="_blank" rel="noopener">http://whatweb.bugscaner.com/look/</a><br><a href="http://www.yunsee.cn/finger.html" target="_blank" rel="noopener">http://www.yunsee.cn/finger.html</a></p>
<h5 id="4、对waf进行识别"><a href="#4、对waf进行识别" class="headerlink" title="4、对waf进行识别"></a>4、对<code>waf</code>进行识别</h5><p>这里有一款开源的识别工具，挺好用的<br><a href="https://github.com/EnableSecurity/wafw00f" target="_blank" rel="noopener">https://github.com/EnableSecurity/wafw00f</a></p>
<h5 id="5、对网站whois查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）"><a href="#5、对网站whois查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）" class="headerlink" title="5、对网站whois查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）"></a>5、对网站<code>whois</code>查询看注册人、手机号、邮箱等（可以收集起来放到密码生成工具）</h5><h5 id="6、看html源代码，在一起项目测试的时候，我在找html源代码的时候发现一个注释的js文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没get到shell，所以你要知道这回事而不要记住这件事）"><a href="#6、看html源代码，在一起项目测试的时候，我在找html源代码的时候发现一个注释的js文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没get到shell，所以你要知道这回事而不要记住这件事）" class="headerlink" title="6、看html源代码，在一起项目测试的时候，我在找html源代码的时候发现一个注释的js文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没get到shell，所以你要知道这回事而不要记住这件事）"></a>6、看<code>html</code>源代码，在一起项目测试的时候，我在找<code>html</code>源代码的时候发现一个注释的<code>js</code>文件，我将其打开后，里面的备注居然是配置信息。。。后台地址、管理员账号和密码等（可是我没<code>get</code>到<code>shell</code>，所以你要知道这回事而不要记住这件事）</h5><h5 id="7、网站真实ip识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来"><a href="#7、网站真实ip识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来" class="headerlink" title="7、网站真实ip识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来"></a>7、网站真实<code>ip</code>识别，下面是我用的一个工具，但是我忘记哪里下载的了，我原封不漏的粘贴出来</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"><span class="comment">#############################################################</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###                                                  </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###   ▄▄▄▄                ▄▄▄     ▄▄▄▄    ▀      ▄   </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###  ▀   ▀█ ▄   ▄  ▄▄▄▄     █    ▄▀  ▀▄ ▄▄▄    ▄▄█▄▄ </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###    ▄▄▄▀  █▄█   █▀ ▀█    █    █  ▄ █   █      █   </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###      ▀█  ▄█▄   █   █    █    █    █   █      █   </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###  ▀▄▄▄█▀ ▄▀ ▀▄  ██▄█▀  ▄▄█▄▄   █▄▄█  ▄▄█▄▄    ▀▄▄ </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###                █                                 </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###                ▀                                 </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="comment">###                                                          </span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="comment">### name: xcdn.py</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="comment">### function: try to get the actual ip behind cdn</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="comment">### date: 2016-11-05</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="comment">### author: quanyechavshuo</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="comment">### blog: http://3xp10it.cc</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="comment">#############################################################</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="comment"># usage:python3 xcdn.py www.baidu.com</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line">os.system(<span class="string">"pip3 install exp10it -U --no-cache-dir"</span>)    </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> figlet2file</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line">figlet2file(<span class="string">"3xp10it"</span>,<span class="number">0</span>,<span class="literal">True</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line">time.sleep(<span class="number">1</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> CLIOutput</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> get_root_domain</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> get_string_from_command</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> get_http_or_https</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> post_request</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> get_request</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> exp10it <span class="keyword">import</span> checkvpn</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Xcdn</span><span class="params">(object)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,domain)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#必须保证连上了vpn,要在可以ping通google的条件下使用本工具,否则有些domain由于被GFW拦截无法正常访问会导致</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#本工具判断错误,checkvpn在可以ping通google的条件下返回1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> checkvpn()==<span class="number">1</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">break</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line">                time.sleep(<span class="number">1</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line">                print(<span class="string">"vpn is off,connect vpn first"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> domain[:<span class="number">4</span>]==<span class="string">"http"</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">            print(<span class="string">"domain format error,make sure domain has no http,like www.baidu.com but not \</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line"><span class="string">http://www.baidu.com"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">            sys.exit(<span class="number">0</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#首先保证hosts文件中没有与domain相关的项,有则删除相关</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line">        domainPattern=domain.replace(<span class="string">"."</span>,<span class="string">"\."</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#下面的sed的正则中不能有\n,sed匹配\n比较特殊</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#http://stackoverflow.com/questions/1251999/how-can-i-replace-a-newline-n-using-sed</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">        command=<span class="string">"sed -ri 's/.*\s+%s//' /etc/hosts"</span> % domainPattern</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line">        os.system(command)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">        self.domain=domain</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line">        self.http_or_https=get_http_or_https(self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">        print(<span class="string">'domain的http或https是:%s'</span> % self.http_or_https)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line">        result=get_request(self.http_or_https+<span class="string">"://"</span>+self.domain,<span class="string">'seleniumPhantomJS'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line">        self.domain_title=result[<span class="string">'title'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#下面调用相当于main函数的get_actual_ip_from_domain函数</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line">        actual_ip = self.get_actual_ip_from_domain()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> actual_ip != <span class="number">0</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">            print(<span class="string">"恭喜,%s的真实ip是%s"</span> % (self.domain, actual_ip))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#下面用来存放关键返回值</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">        self.return_value=actual_ip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">        </span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">domain_has_cdn</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 检测domain是否有cdn</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 有cdn时,返回一个字典,如果cdn是cloudflare，返回&#123;'has_cdn':1,'is_cloud_flare':1&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 否则返回&#123;'has_cdn':1,'is_cloud_flare':0&#125;或&#123;'has_cdn':0,'is_cloud_flare':0&#125;</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">import</span> re</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在检测domain:%s是否有cdn"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">        has_cdn = <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># ns记录和mx记录一样,都要查顶级域名,eg.dig +short www.baidu.com ns VS dig +short baidu.com ns</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">        result = get_string_from_command(<span class="string">"dig ns %s +short"</span> % get_root_domain(self.domain))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line">        pattern = re.compile(</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line">            <span class="string">r"(cloudflare)|(cdn)|(cloud)|(fast)|(incapsula)|(photon)|(cachefly)|(wppronto)|(softlayer)|(incapsula)|(jsdelivr)|(akamai)"</span>, re.I)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">        cloudflare_pattern = re.compile(<span class="string">r"cloudflare"</span>, re.I)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> re.search(pattern, result):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> re.search(cloudflare_pattern, result):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">                print(<span class="string">"has_cdn=1 from ns,and cdn is cloudflare"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> &#123;<span class="string">'has_cdn'</span>: <span class="number">1</span>, <span class="string">'is_cloud_flare'</span>: <span class="number">1</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line">                print(<span class="string">"has_cdn=1 from ns"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> &#123;<span class="string">'has_cdn'</span>: <span class="number">1</span>, <span class="string">'is_cloud_flare'</span>: <span class="number">0</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line">            <span class="comment"># 下面通过a记录个数来判断,如果a记录个数&gt;1个,认为有cdn</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line">            result = get_string_from_command(<span class="string">"dig a %s +short"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">            find_a_record_pattern = re.findall(<span class="string">r"((\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;)"</span>, result)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> find_a_record_pattern:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line">                ip_count = <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">for</span> each <span class="keyword">in</span> find_a_record_pattern:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line">                    ip_count += <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">if</span> ip_count &gt; <span class="number">1</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">                    has_cdn = <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">                    <span class="keyword">return</span> &#123;<span class="string">'has_cdn'</span>: <span class="number">1</span>, <span class="string">'is_cloud_flare'</span>: <span class="number">0</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> &#123;<span class="string">'has_cdn'</span>: <span class="number">0</span>, <span class="string">'is_cloud_flare'</span>: <span class="number">0</span>&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_domain_actual_ip_from_phpinfo</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 从phpinfo页面尝试获得真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在尝试从domain:%s可能存在的phpinfo页面获取真实ip"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line">        phpinfo_page_list = [<span class="string">"info.php"</span>, <span class="string">"phpinfo.php"</span>, <span class="string">"test.php"</span>, <span class="string">"l.php"</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> phpinfo_page_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line">            url = self.http_or_https + <span class="string">"://"</span> + self.domain + <span class="string">"/"</span> + each</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"现在访问%s"</span> % url)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line">            visit = get_request(url,<span class="string">'seleniumPhantomJS'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line">            code = visit[<span class="string">'code'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">            content = visit[<span class="string">'content'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line">            pattern = re.compile(<span class="string">r"remote_addr"</span>, re.I)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> code == <span class="number">200</span> <span class="keyword">and</span> re.search(pattern, content):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line">                print(each)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line">                actual_ip = re.search(<span class="string">r"REMOTE_ADDR[^\.\d]+([\d\.]&#123;7,15&#125;)[^\.\d]+"</span>, content).group(<span class="number">1</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> actual_ip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">118</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># return 0代表没有通过phpinfo页面得到真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">119</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">120</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">121</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">122</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">flush_dns</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">123</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 这个函数用来刷新本地dns cache</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">124</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 要刷新dns cache才能让修改hosts文件有效</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">125</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在刷新系统的dns cache"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">126</span></pre></td><td class="code"><pre><span class="line">        command = <span class="string">"service network-manager restart &amp;&amp; /etc/init.d/networking force-reload"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">127</span></pre></td><td class="code"><pre><span class="line">        os.system(command)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">128</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">import</span> time</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">129</span></pre></td><td class="code"><pre><span class="line">        time.sleep(<span class="number">3</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">130</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">131</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">132</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">modify_hosts_file_with_ip_and_domain</span><span class="params">(self,ip)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">133</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 这个函数用来修改hosts文件</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">134</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在修改hosts文件"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">135</span></pre></td><td class="code"><pre><span class="line">        exists_domain_line = <span class="literal">False</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">136</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">with</span> open(<span class="string">"/etc/hosts"</span>, <span class="string">"r+"</span>) <span class="keyword">as</span> f:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">137</span></pre></td><td class="code"><pre><span class="line">            file_content = f.read()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">138</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> re.search(<span class="string">r"%s"</span> % self.domain.replace(<span class="string">"."</span>, <span class="string">"\."</span>), file_content):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">139</span></pre></td><td class="code"><pre><span class="line">            exists_domain_line = <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">140</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> exists_domain_line == <span class="literal">True</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">141</span></pre></td><td class="code"><pre><span class="line">            os.system(<span class="string">"sed -ri 's/.*%s.*/%s    %s/' %s"</span> % (self.domain.replace(<span class="string">"."</span>, <span class="string">"\."</span>), ip, self.domain, <span class="string">"/etc/hosts"</span>))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">142</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">143</span></pre></td><td class="code"><pre><span class="line">            os.system(<span class="string">"echo %s %s &gt;&gt; /etc/hosts"</span> % (ip, self.domain))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">144</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">145</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">146</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_if_ip_is_actual_ip_of_domain</span><span class="params">(self,ip)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">147</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 通过修改hosts文件检测ip是否是domain对应的真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">148</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 如果是则返回True,否则返回False</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">149</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#CLIOutput().good_print("现在通过修改hosts文件并刷新dns的方法检测ip:%s是否是domain:%s的真实ip" % (ip,self.domain))</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">150</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#python通过requests库或mechanicalsoup库或selenium_phantomjs来请求时不会被dns缓存影响，只会被hosts文件影响dns解析,人工用浏览器访问域名则会受dns缓存影响</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">151</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在通过修改hosts文件的方法检测ip:%s是否是domain:%s的真实ip"</span> % (ip,self.domain))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">152</span></pre></td><td class="code"><pre><span class="line">        os.system(<span class="string">"cp /etc/hosts /etc/hosts.bak"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">153</span></pre></td><td class="code"><pre><span class="line">        self.modify_hosts_file_with_ip_and_domain(ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">154</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#python通过requests库或mechanicalsoup库或selenium_phantomjs来请求时不会被dns缓存影响，只会被hosts文件影响dns解析,人工用浏览器访问域名则会受dns缓存影响</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">155</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#self.flush_dns()</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">156</span></pre></td><td class="code"><pre><span class="line">        hosts_changed_domain_title= get_request(self.http_or_https + <span class="string">"://%s"</span> % self.domain,<span class="string">'selenium_phantom_js'</span>)[<span class="string">'title'</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">157</span></pre></td><td class="code"><pre><span class="line">        os.system(<span class="string">"rm /etc/hosts &amp;&amp; mv /etc/hosts.bak /etc/hosts"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">158</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#这里要用title判断,html判断不可以,title相同则认为相同</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">159</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> self.domain_title == hosts_changed_domain_title:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">160</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"检测到真实ip!!!!!!"</span>,<span class="string">'red'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">161</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">162</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">163</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"当前ip不是域名的真实ip"</span>,<span class="string">'yellow'</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">164</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">165</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">166</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">167</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_c_80_or_443_list</span><span class="params">(self,ip)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">168</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 得到ip的整个c段的开放80端口或443端口的ip列表</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">169</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> <span class="string">"not found"</span> <span class="keyword">in</span> get_string_from_command(<span class="string">"masscan"</span>):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">170</span></pre></td><td class="code"><pre><span class="line">            <span class="comment">#这里不用nmap扫描,nmap扫描结果不准</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">171</span></pre></td><td class="code"><pre><span class="line">            os.system(<span class="string">"apt-get install masscan"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">172</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> self.http_or_https==<span class="string">"http"</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">173</span></pre></td><td class="code"><pre><span class="line">            scanPort=<span class="number">80</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">174</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"现在进行%s的c段开了80端口机器的扫描"</span> % ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">175</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> self.http_or_https==<span class="string">"https"</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">176</span></pre></td><td class="code"><pre><span class="line">            scanPort=<span class="number">443</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">177</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"现在进行%s的c段开了443端口机器的扫描"</span> % ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">178</span></pre></td><td class="code"><pre><span class="line">        masscan_command = <span class="string">"masscan -p%d %s/24 &gt; /tmp/masscan.out"</span> % (scanPort,ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">179</span></pre></td><td class="code"><pre><span class="line">        os.system(masscan_command)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">180</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">with</span> open(<span class="string">"/tmp/masscan.out"</span>, <span class="string">"r+"</span>) <span class="keyword">as</span> f:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">181</span></pre></td><td class="code"><pre><span class="line">            strings = f.read()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">182</span></pre></td><td class="code"><pre><span class="line">        <span class="comment">#os.system("rm /tmp/masscan.out")</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">183</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">import</span> re</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">184</span></pre></td><td class="code"><pre><span class="line">        allIP=re.findall(<span class="string">r"((\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;)"</span>,strings)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">185</span></pre></td><td class="code"><pre><span class="line">        ipList=[]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">186</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> allIP:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">187</span></pre></td><td class="code"><pre><span class="line">            ipList.append(each[<span class="number">0</span>])</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">188</span></pre></td><td class="code"><pre><span class="line">        print(ipList)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">189</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> ipList</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">190</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">191</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">192</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_if_ip_c_machines_has_actual_ip_of_domain</span><span class="params">(self,ip)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">193</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 检测ip的c段有没有domain的真实ip,如果有则返回真实ip,如果没有则返回0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">194</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在检测ip为%s的c段中有没有%s的真实ip"</span> % (ip,self.domain))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">195</span></pre></td><td class="code"><pre><span class="line">        target_list=self.get_c_80_or_443_list(ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">196</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> each_ip <span class="keyword">in</span> target_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">197</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> <span class="literal">True</span> == self.check_if_ip_is_actual_ip_of_domain(each_ip):</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">198</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> each_ip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">199</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">200</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">201</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">202</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_ip_from_mx_record</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">203</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 从mx记录中得到ip列表,尝试从mx记录中的c段中找真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">204</span></pre></td><td class="code"><pre><span class="line">        print(<span class="string">"尝试从mx记录中找和%s顶级域名相同的mx主机"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">205</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">import</span> socket</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">206</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># domain.eg:www.baidu.com</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">207</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">from</span> exp10it <span class="keyword">import</span> get_root_domain</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">208</span></pre></td><td class="code"><pre><span class="line">        root_domain = get_root_domain(self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">209</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">from</span> exp10it <span class="keyword">import</span> get_string_from_command</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">210</span></pre></td><td class="code"><pre><span class="line">        result = get_string_from_command(<span class="string">"dig %s +short mx"</span> % root_domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">211</span></pre></td><td class="code"><pre><span class="line">        sub_domains_list = re.findall(<span class="string">r"\d&#123;1,&#125; (.*\.%s)\."</span> % root_domain.replace(<span class="string">"."</span>, <span class="string">"\."</span>), result)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">212</span></pre></td><td class="code"><pre><span class="line">        ip_list = []</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">213</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> sub_domains_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">214</span></pre></td><td class="code"><pre><span class="line">            print(each)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">215</span></pre></td><td class="code"><pre><span class="line">            ip = socket.gethostbyname_ex(each)[<span class="number">2</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">216</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> ip[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> ip_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">217</span></pre></td><td class="code"><pre><span class="line">                ip_list.append(ip[<span class="number">0</span>])</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">218</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> ip_list</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">219</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">220</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">221</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_if_mx_c_machines_has_actual_ip_of_domain</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">222</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 检测domain的mx记录所在ip[或ip列表]的c段中有没有domain的真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">223</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 有则返回真实ip,没有则返回0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">224</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"尝试从mx记录的c段中查找是否存在%s的真实ip"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">225</span></pre></td><td class="code"><pre><span class="line">        ip_list = self.get_ip_from_mx_record()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">226</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> ip_list != []:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">227</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">for</span> each_ip <span class="keyword">in</span> ip_list:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">228</span></pre></td><td class="code"><pre><span class="line">                result = self.check_if_ip_c_machines_has_actual_ip_of_domain(each_ip)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">229</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">if</span> result != <span class="number">0</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">230</span></pre></td><td class="code"><pre><span class="line">                    <span class="keyword">return</span> result</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">231</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">232</span></pre></td><td class="code"><pre><span class="line">                    <span class="keyword">continue</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">233</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">234</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">235</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">236</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_ip_value_from_online_cloudflare_interface</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">237</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 从在线的cloudflare查询真实ip接口处查询真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">238</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 如果查询到真实ip则返回ip值,如果没有查询到则返回0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">239</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"现在从在线cloudflare类型cdn查询真实ip接口尝试获取真实ip"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">240</span></pre></td><td class="code"><pre><span class="line">        url = <span class="string">"http://www.crimeflare.com/cgi-bin/cfsearch.cgi"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">241</span></pre></td><td class="code"><pre><span class="line">        post_data = <span class="string">'cfS=%s'</span> % self.domain</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">242</span></pre></td><td class="code"><pre><span class="line">        content = post_request(url, post_data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">243</span></pre></td><td class="code"><pre><span class="line">        findIp = re.search(<span class="string">r"((\d&#123;1,3&#125;\.)&#123;3&#125;\d&#123;1,3&#125;)"</span>, content)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">244</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> findIp:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">245</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> findIp.group(<span class="number">1</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">246</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">247</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">248</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">249</span></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_actual_ip_from_domain</span><span class="params">(self)</span>:</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">250</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 尝试获得domain背后的真实ip,前提是domain有cdn</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">251</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 如果找到了则返回ip,如果没有找到返回0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">252</span></pre></td><td class="code"><pre><span class="line">        CLIOutput().good_print(<span class="string">"进入获取真实ip函数,认为每个domain都是有cdn的情况来处理"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">253</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">import</span> socket</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">254</span></pre></td><td class="code"><pre><span class="line">        has_cdn_value = self.domain_has_cdn()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">255</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> has_cdn_value[<span class="string">'has_cdn'</span>] == <span class="number">1</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">256</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"检测到domain:%s的A记录不止一个,认为它有cdn"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">257</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">pass</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">258</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">259</span></pre></td><td class="code"><pre><span class="line">            CLIOutput().good_print(<span class="string">"Attention...!!! Domain doesn't have cdn,I will return the only one ip"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">260</span></pre></td><td class="code"><pre><span class="line">            true_ip = socket.gethostbyname_ex(self.domain)[<span class="number">2</span>][<span class="number">0</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">261</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> true_ip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">262</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 下面尝试通过cloudflare在线查询真实ip接口获取真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">263</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> has_cdn_value[<span class="string">'is_cloud_flare'</span>] == <span class="number">1</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">264</span></pre></td><td class="code"><pre><span class="line">            ip_value = self.get_ip_value_from_online_cloudflare_interface()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">265</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">if</span> ip_value != <span class="number">0</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">266</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">return</span> ip_value</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">267</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">268</span></pre></td><td class="code"><pre><span class="line">                <span class="keyword">pass</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">269</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 下面尝试通过可能存在的phpinfo页面获得真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">270</span></pre></td><td class="code"><pre><span class="line">        ip_from_phpinfo = self.get_domain_actual_ip_from_phpinfo()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">271</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> ip_from_phpinfo == <span class="number">0</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">272</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">pass</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">273</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">274</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> ip_from_phpinfo</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">275</span></pre></td><td class="code"><pre><span class="line">        <span class="comment"># 下面通过mx记录来尝试获得真实ip</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">276</span></pre></td><td class="code"><pre><span class="line">        result = self.check_if_mx_c_machines_has_actual_ip_of_domain()</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">277</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">if</span> result == <span class="number">0</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">278</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">pass</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">279</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">else</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">280</span></pre></td><td class="code"><pre><span class="line">            <span class="keyword">return</span> result</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">281</span></pre></td><td class="code"><pre><span class="line">        print(<span class="string">"很遗憾,在下认为%s有cdn,但是目前在下的能力没能获取它的真实ip,当前函数将返回0"</span> % self.domain)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">282</span></pre></td><td class="code"><pre><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">283</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">284</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">285</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">286</span></pre></td><td class="code"><pre><span class="line">    <span class="keyword">import</span> sys</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">287</span></pre></td><td class="code"><pre><span class="line">    domain=sys.argv[<span class="number">1</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">288</span></pre></td><td class="code"><pre><span class="line">    Xcdn(domain)</span></pre></td></tr></table></figure>
<h5 id="8、服务器ssh配置信息"><a href="#8、服务器ssh配置信息" class="headerlink" title="8、服务器ssh配置信息"></a>8、服务器ssh配置信息</h5><p>丢工具：<a href="https://github.com/mozilla/ssh_scan" target="_blank" rel="noopener">https://github.com/mozilla/ssh_scan</a></p>
<h5 id="9、敏感文件爆破"><a href="#9、敏感文件爆破" class="headerlink" title="9、敏感文件爆破"></a>9、敏感文件爆破</h5><ul>
<li><code>svn</code>源代码泄露使用<code>svn</code>版本控制系统时，错误操作将<code>.svn</code>文件存放，那么久可以看他<code>SVN</code>服务器账号密码等信息</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx.xxx&#x2F;.svn&#x2F;entries</span></pre></td></tr></table></figure>

<h5 id="10、根据目标系统情况"><a href="#10、根据目标系统情况" class="headerlink" title="10、根据目标系统情况"></a>10、根据目标系统情况</h5><p>根据目标系统情况是因为看他对应的系统是什么对应有什么漏洞，下面这个是<code>tomcat</code>的<code>session</code>泄露</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;examples&#x2F;servlets&#x2F;servlet&#x2F;SessionExample&#x2F;examples&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;examples&#x2F;servlets&#x2F;servlet&#x2F;SessionExample</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x2F;examples&#x2F;</span></pre></td></tr></table></figure>

<p><img src="http://static.zybuluo.com/1kbfree/c4nub4ydmq1402ccx0sav3x9/image_1dbvfielukp81f701hcd1qnq12e41j.png" alt="image_1dbvfielukp81f701hcd1qnq12e41j.png-57.6kB"></p>
<h3 id="敏感目录泄露"><a href="#敏感目录泄露" class="headerlink" title="敏感目录泄露"></a>敏感目录泄露</h3><ul>
<li><code>WEB-INF/web.xml</code>泄露</li>
</ul>
<p><code>WEB-INF</code>是<code>Java</code>的<code>WEB</code>应用的安全目录。如果想在页面中直接访问其中的文件，必须通过<code>web.xml</code>文件对要访问的文件进行相应映射才能访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;config&#x2F;jdbc.properties</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;web.xml</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;classes&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;lib&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;src&#x2F;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#x2F;WEB-INF&#x2F;database.properties</span></pre></td></tr></table></figure>

<ul>
<li><code>bzr</code>泄露</li>
</ul>
<p>通过它我们可以看项目历史</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx.xxx&#x2F;.bzr&#x2F;</span></pre></td></tr></table></figure>

<ul>
<li>网站源代码泄露</li>
</ul>
<p>不多介绍，可能管理员觉得网站不安全，需要我们审计一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">www.zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line">www.tar.gz</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line">www.rar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">web.zip</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line">web.rar</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">...</span></pre></td></tr></table></figure>

<p>这些有很多，，不一一详细，后面我会将这些全部集合在一个字典里，然后我们可以放入目录遍历的工具里批量扫~</p>
<h3 id="利用shodan、fofa等收集信息"><a href="#利用shodan、fofa等收集信息" class="headerlink" title="利用shodan、fofa等收集信息"></a>利用shodan、fofa等收集信息</h3><p>查找标题是携程并且语言是国语的站点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.shodan.io&#x2F;search?query&#x3D;http.title:&quot;携程&quot; country:&quot;CN&quot;</span></pre></td></tr></table></figure>

<p><img src="http://static.zybuluo.com/1kbfree/6c72ksiz5fz1js4zomzvy6q3/image_1dbvfuq8rvjho6e3qd1etn1va420.png" alt="image_1dbvfuq8rvjho6e3qd1etn1va420.png-338.8kB"></p>
<p>我们可以将其收藏为文件夹，方便下次打开，然后记录时间，看看有没有新上线的（这里已经有监控的功能，各位师傅可以去看看米斯特大佬写的<code>shodan</code>监控文章，很有趣很实用）</p>
<p><code>shodan</code>、<code>fofa</code>不多介绍了，有对应的手册，见的肯定比我好</p>
<h3 id="思路扩展"><a href="#思路扩展" class="headerlink" title="思路扩展"></a>思路扩展</h3><p>思路扩展就是在<code>a</code>功能点中找出<code>b</code>功能点，以此类推</p>
<p>比如一些后台登录是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx.xxx&#x2F;admin-login</span></pre></td></tr></table></figure>

<p>我们是不是可以尝试吧<code>login</code>改成<code>register</code>来注册</p>
<p>再比如获取用户手机号的接口（这里不存在越权）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx.xxx&#x2F;user&#x2F;GetPhone&#x2F;?id&#x3D;1</span></pre></td></tr></table></figure>

<p>然后我们把<code>GetPhone</code>改成<code>GetPasswd</code>或者<code>GetPwd</code>或者<code>GetPassword</code>然后<code>id</code>就可能可以越权，或者这里可以<code>json</code>劫持或者<code>origin</code>劫持等，我们可以诱导用户点开来劫持账号密码</p>
<p>或者还是看源代码，然后搜索<code>hidden</code>（滑稽），我们可能可能会找到敏感操作的按钮，然后管理员也知道敏感，将其”隐藏”了，我们可以根据这个来搜索然后访问他，嘿嘿嘿（之前对一个小站点进行挖掘的时候我<code>hidden</code>找居然找到了不可描述的目录下面放着不可描述的电影，当时我的心情是非常拒绝的，经过几小时的思考我迅速的将那个目录关闭了，毕竟我是祖国的花朵）</p>
<p>这里有很多是<code>adrian</code>师傅与我分享的，然后暂时只写那么多吧（其实还有几个，怕触犯到权什么的就是他给你学了但不给我写的那种，很麻烦所以就以后有机会再写吧），如果遇到了更多我会补充</p>
<blockquote>
<p>来源于网络，回馈于网络</p>
</blockquote>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最終更新：<time datetime="2019-12-17T19:21:48.080Z" itemprop="dateUpdated">2019-12-18 03:21:48</time>
</span><br>


        
        未经允许，禁止转载：<a href="/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" target="_blank" rel="external">https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/</a>
        
    </div>
    
    <footer>
        <a href="https://fuckgo.github.io">
            <img src="/img/blog.jpg" alt="$_Fuck">
            $_Fuck
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" target="_blank" rel="noopener" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&title=《信息收集之我见》 — $_Fuck&pic=https://fuckgo.github.io/img/blog.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" target="_blank" rel="noopener" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&title=《信息收集之我见》 — $_Fuck&source=无助就算了，还要假装坚强。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《信息收集之我见》 — $_Fuck&url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&via=https://fuckgo.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" target="_blank" rel="noopener" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019/12/18/%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8B%BF%E4%B8%8Bshell%E8%BF%87%E7%A8%8B/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">一次渗透测试拿下shell过程</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019/12/18/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4%E6%80%BB%E7%BB%93/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">sql注入绕过过滤总结</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;" target="_blank" rel="noopener"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        禁止打赏~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/" data-alipay="/img/">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        
    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" target="_blank" rel="noopener" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&title=《信息收集之我见》 — $_Fuck&pic=https://fuckgo.github.io/img/blog.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" target="_blank" rel="noopener" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&title=《信息收集之我见》 — $_Fuck&source=无助就算了，还要假装坚强。" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《信息收集之我见》 — $_Fuck&url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/&via=https://fuckgo.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;" target="_blank" rel="noopener"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=https://fuckgo.github.io/2019/12/18/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8B%E6%88%91%E8%A7%81/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Bay！';
            clearTimeout(titleTime);
        } else {
            document.title = 'Fuck的博客~';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
